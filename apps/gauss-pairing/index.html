<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>حيـلة غاوس – تجميع (تزاوج) الأعداد بصريًا</title>
  <link rel="icon" href="../../assets/favicon.ico">
  <link rel="stylesheet" href="gauss.css?v=2025-11-01c">
</head>
<body>

  <!-- شعار أعلى اليسار -->
  <a class="brand-logo" href="https://ibrahimieh.edu/" target="_blank" rel="noopener"
     title="الكلية الإبراهيمية بالقدس">
    <img src="../../assets/ibrahimieh-logo-black.png" alt="شعار الكلية الإبراهيمية بالقدس">
  </a>

  <div class="shell">
    <header>
      <div class="topbar">
        <a class="back btn ghost small" href="../../index.html" title="الرجوع للفهرس">↩︎ الرجوع للفهرس</a>
        <h1>حيـلة غاوس – تجميع (تزاوج) الأعداد بصريًا</h1>
      </div>
      <p>
        نبني سُلّمًا من المكعبات من <b>1</b> إلى <b id="nSpanTop">20</b> ثم نُكمِّله بمكعبات مكافئة لتتكوّن مُستطيل أبعاده
        <b id="dimsTop">21 × 20</b> ليتضح أن <span dir="ltr">2S = n(n+1)</span> ثم <span dir="ltr">S = n(n+1)/2</span>.
      </p>
    </header>

    <!-- لوحة التحكم -->
    <div class="panel">
      <button id="play" class="btn primary">تشغيل التزاوج</button>
      <button id="step" class="btn">خطوة</button>
      <button id="reset" class="btn">إعادة الضبط</button>

      <button id="storyBtn" class="btn" title="القصة وراء اكتشاف حيـلة غاوس">القصة</button>

      <!-- منظور + عمق -->
      <div class="isoGroup">
        <button id="isoToggle" class="btn ghost" aria-pressed="false" title="تبديل عرض المكعبات: مسطّح/إيزومتري">
          منظور: مسطّح
        </button>
        <label id="depthCtrl" class="depthCtrl muted" for="depthRange" title="التحكم بعمق الإيزومتري">
          العمق:
          <input type="range" id="depthRange" min="4" max="20" step="1" value="10">
          <span id="depthValue">10px</span>
        </label>
      </div>

      <!-- مجموعة التكبير -->
      <div class="zoomGroup">
        <button id="zoomOut" class="btn small">تصغير −</button>
        <button id="zoomReset" class="btn small">100%</button>
        <button id="zoomIn" class="btn small">تكبير +</button>
      </div>

      <div class="grow"></div>

      <!-- عدد الدرجات -->
      <label class="rangeLab">عدد الدرجات (n):</label>
      <input id="nRange" type="range" min="3" max="30" step="1" value="20" />
      <span id="nLabel">20</span>
    </div>

    <p class="hint">نصيحة: عدِّل n ثم اضغط تشغيل. يمكنك المشاهدة <b>خطوة بخطوة</b> أيضًا.</p>

    <!-- ساحة العرض -->
    <div class="arena" id="arena">
      <div id="stage">
        <div class="grid" id="grid"></div>

        <div class="legend">
          <span class="k"><span class="pill" style="background:linear-gradient(180deg,#3b82f6,#1e40af)"></span> السُّلَّم الأصلي (A)</span>
          <span class="k"><span class="pill" style="background:linear-gradient(180deg,#34d399,#065f46)"></span> المُكمل (B) لإكمال المستطيل</span>
        </div>

        <div class="formula" id="formulaBox">
          <div>بسبب التزاوج صفًا صفًا نحصل على مُستطيل بعدده <b id="rectCells">420</b> مكعبًا.</div>
          <div>إذًا <span dir="ltr">2S = n(n+1)</span> ⇒ <b dir="ltr">S = n(n+1)/2 = <span id="sumVal">210</span></b>.</div>
        </div>

        <!-- خطوط إرشادية تظهر بعد الاكتمال -->
        <svg class="guides" id="guides" viewBox="0 0 100 100" preserveAspectRatio="none" aria-hidden="true">
          <line x1="0" y1="95" x2="100" y2="95"></line>
          <line x1="95" y1="0" x2="95" y2="100"></line>
          <text x="50" y="99" text-anchor="middle" class="tMuted" id="guideW">الطول = n</text>
          <text x="98" y="50" text-anchor="end" class="tMuted" id="guideH" transform="rotate(-90 98,50)">العرض = n+1</text>
        </svg>

        <!-- نافذة شرح سريعة بعد الاكتمال -->
        <div class="postExplain hidden" id="postExplain">
          <div class="card">
            <h3>فكرة النتيجة</h3>
            <p>
              بعد اكتمال التزاوج صار لدينا <b>مستطيل</b> بعدده <span id="rectCells2">420</span> مكعبًا،
              أي <span dir="ltr">2S = n(n+1)</span> ⇒ <b dir="ltr">S = n(n+1)/2</b>. هذا هو عدد المكعبات في
              سُلَّمٍ من 1 إلى <b id="nSpan2">20</b>.
            </p>
            <div style="display:flex; gap:8px; justify-content:flex-end">
              <button class="btn ghost small" id="hideExplain">إخفاء</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="footer-note">مُهيّأ للشرح الصّفي للمرحلة الخامسة–السابعة. يمكنك تعديل عدد الدرجات والسرعة وتشغيل الأنيميشن خطوة بخطوة.</div>
      <div class="credit">إعداد: زهدي زاهدة — الكلية الإبراهيمية بالقدس</div>
    </div>
  </div>

  <!-- نافذة القصة -->
  <div class="modal" id="storyModal" aria-hidden="true" role="dialog" aria-labelledby="storyTitle">
    <div class="card">
      <div class="modalHead">
        <h2 id="storyTitle">القصة وراء اكتشاف حيـلة غاوس</h2>
        <button class="btn ghost small" id="closeStory">✕</button>
      </div>

      <div class="segmented" role="tablist" aria-label="اختيار نص القصة">
        <button id="tabShort" class="seg"  role="tab" aria-selected="false">نص قصير (للصف الخامس)</button>
        <button id="tabFull"  class="seg active" role="tab" aria-selected="true">نص كامل</button>
      </div>

      <div class="story" id="storyText"></div>

      <div class="controls">
        <button id="ttsPlay"  class="btn small">استمع</button>
        <button id="ttsStop"  class="btn ghost small">إيقاف</button>

        <fieldset class="voiceGroup">
          <legend class="muted">نبرة الصوت:</legend>
          <label><input type="radio" name="voice" value="kid"   checked> طفل</label>
          <label><input type="radio" name="voice" value="adult"> معلّم</label>
          <span class="muted">إن وُجد ملف MP3 مطابق للنبرة سيُستخدم تلقائيًا، وإلا سيُستخدم TTS.</span>
        </fieldset>
      </div>
    </div>
  </div>

  <script src="gauss.js?v=2025-11-01c"></script>
</body>
</html>
